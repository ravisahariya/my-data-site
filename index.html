<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Attendance Master</title>

<style>
body{
margin:0;
font-family:Arial;
background:linear-gradient(135deg,#5f72ff,#9b59b6);
}

/* ================= LOGIN ================= */

#loginPage{
height:100vh;
display:flex;
justify-content:center;
align-items:center;
}

.loginCard{
background:#fff;
width:95%;
max-width:520px;
padding:50px;
border-radius:25px;
text-align:center;
box-shadow:0 15px 45px rgba(0,0,0,.35);
}

.loginCard h2{
font-size:34px;
margin-bottom:10px;
}

.loginInput{
width:100%;
padding:16px;
margin:10px 0;
font-size:18px;
}

.bigBtn{
padding:12px 30px;
font-size:18px;
margin:6px;
}

#clock{
color:#1976d2;
font-weight:bold;
margin-bottom:15px;
}

/* ================= APP ================= */

#app{
display:none;
height:100vh;
flex-direction:column;
}

/* header fixed */
header{
background:#1565c0;
color:white;
padding:12px;
font-size:20px;
display:flex;
justify-content:space-between;
align-items:center;
position:sticky;
top:0;
}

.logoutBtn{
background:red;
color:white;
border:none;
padding:8px 14px;
}

/* entry form */
#entry{
background:#d9ecff;
padding:10px;
}

table{
width:100%;
border-collapse:collapse;
}

th,td{
border:1px solid #ccc;
padding:6px;
text-align:center;
}

th{
background:#ffd6d6;
}

tbody{
display:block;
height:60vh;
overflow:auto;
}

thead, tbody tr{
display:table;
width:100%;
table-layout:fixed;
}

footer{
background:#ffeaa7;
padding:10px;
font-weight:bold;
position:sticky;
bottom:0;
}

.night{
background:#e3f2fd;
}
</style>
</head>

<body>

<!-- ================= LOGIN PAGE ================= -->

<div id="loginPage">
<div class="loginCard">

<h2>üîê Attendance Login</h2>
<div id="clock"></div>

<input id="user" class="loginInput" placeholder="Username">
<input id="pass" type="password" class="loginInput" placeholder="Password">

<button class="bigBtn" onclick="login()">Login</button>
<button class="bigBtn" onclick="secret()">üîí Secret</button>

</div>
</div>


<!-- ================= DASHBOARD ================= -->

<div id="app">

<header>
üìä <b>ATTENDANCE MASTER DATA</b>
<button class="logoutBtn" onclick="logout()">Logout</button>
</header>

<div id="entry">
üïí <span id="runClock"></span><br>

<input type="date" id="date">
<input type="time" id="in">
<input type="time" id="out">
<input id="post" placeholder="Post">
<button onclick="save()">Save</button>

<select id="monthFilter" onchange="render()">
<option value="all">All</option>
<option value="0">January</option>
<option value="1">February</option>
<option value="2">March</option>
<option value="3">April</option>
<option value="4">May</option>
<option value="5">June</option>
<option value="6">July</option>
<option value="7">August</option>
<option value="8">September</option>
<option value="9">October</option>
<option value="10">November</option>
<option value="11">December</option>
</select>
</div>

<table>
<thead>
<tr>
<th>Date</th>
<th>In</th>
<th>Out</th>
<th>Hours</th>
<th>Post</th>
<th>Delete</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<footer>
Total Duty: <span id="duty">0</span> |
Total Hours: <span id="hours">0</span>
</footer>

</div>


<script>

/* ================= DEFAULT LOGIN ================= */

if(!localStorage.user){
localStorage.user="9823087";
localStorage.pass="7284";
}

function login(){
if(user.value==localStorage.user && pass.value==localStorage.pass){
localStorage.logged="yes";
showApp();
}else alert("Wrong");
}

function logout(){
localStorage.logged="";
location.reload();
}

function showApp(){
loginPage.style.display="none";
app.style.display="flex";
render();
}

if(localStorage.logged=="yes") showApp();


/* ================= SECRET ================= */

function secret(){
let s=prompt("Enter secret year");
if(s=="1995"){
alert("Username: "+localStorage.user+"\nPassword: "+localStorage.pass);

let old=prompt("Old password");
if(old!=localStorage.pass) return;

let u=prompt("New username");
let p=prompt("New password");
let c=prompt("Confirm password");

if(p!=c) return alert("Not match");

localStorage.user=u;
localStorage.pass=p;

alert("Changed successfully");
}
}


/* ================= CLOCK ================= */

function clock(){
let d=new Date();
clockDiv=d.toLocaleString();
document.getElementById("clock").innerText=clockDiv;
document.getElementById("runClock").innerText=clockDiv;
}
setInterval(clock,1000);


/* ================= DATA ================= */

let data=JSON.parse(localStorage.data||"[]");

function save(){
let d=date.value;
let i=in.value;
let o=out.value;
let p=post.value;

let h=(new Date("1970-01-01 "+o)-new Date("1970-01-01 "+i))/3600000;
if(h<0) h+=24;

data.push({d,i,o,h:h.toFixed(2),p});
localStorage.data=JSON.stringify(data);
render();
}

function del(x){
data.splice(x,1);
localStorage.data=JSON.stringify(data);
render();
}

function render(){
tbody.innerHTML="";
let m=monthFilter.value;

let td=0, th=0;

data.forEach((r,i)=>{

let month=new Date(r.d).getMonth();
if(m!="all" && month!=m) return;

let tr=document.createElement("tr");

if(r.i>r.o) tr.className="night";

tr.innerHTML=`
<td>${r.d}</td>
<td>${r.i}</td>
<td>${r.o}</td>
<td>${r.h}</td>
<td>${r.p}</td>
<td><button onclick="del(${i})">‚ùå</button></td>
`;

tbody.appendChild(tr);

td++;
th+=parseFloat(r.h);
});

duty.innerText=td;
hours.innerText=th.toFixed(2);
}

</script>
</body>
</html>
