<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Duty Register Pro</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>

body{
 background:#eef2f7;
 font-family:system-ui;
}

.card{
 max-width:1200px;
 margin:20px auto;
 padding:20px;
 border-radius:12px;
 box-shadow:0 6px 20px rgba(0,0,0,.15);
}

.hidden{display:none}

.table-box{
 max-height:320px;
 overflow:auto;
}

/* ‚≠ê‚≠ê‚≠ê COLUMN FIX ‚≠ê‚≠ê‚≠ê */
table{
 table-layout:fixed;
 width:100%;
}

th,td{
 white-space:nowrap;
 overflow:hidden;
 text-overflow:ellipsis;
 font-size:14px;
}

th:nth-child(1){width:120px}
th:nth-child(2){width:110px}
th:nth-child(3){width:100px}
th:nth-child(4){width:80px}
th:nth-child(5){width:120px}
th:nth-child(6){width:150px}
th:nth-child(7){width:70px}
th:nth-child(8){width:110px}

.secret{
 background:#f2f2f2;
 padding:10px;
 border-radius:8px;
}

</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginPage" class="card">

<h4 class="text-center">üîê Login</h4>

<div class="secret mb-3">
<input id="year" class="form-control mb-2" placeholder="Secret Year 1995">
<button class="btn btn-secondary w-100" onclick="secret()">Secret</button>
<div id="secretBox" class="hidden text-danger mt-2">
User: admin<br>Password: 12345
</div>
</div>

<input id="uid" class="form-control mb-2" placeholder="User ID">
<input id="pwd" type="password" class="form-control mb-2" placeholder="Password">

<button class="btn btn-primary w-100" onclick="login()">Login</button>

</div>



<!-- APP -->
<div id="app" class="card hidden">

<div class="d-flex justify-content-between">
<b>‡§°‡•ç‡§Ø‡•Ç‡§ü‡•Ä ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ</b>
<button class="btn btn-danger btn-sm" onclick="logout()">Logout</button>
</div>


<form id="form" class="row g-2 mt-3">

<input required id="company" class="form-control col-md-3" placeholder="‡§ï‡§Ç‡§™‡§®‡•Ä">

<input required type="date" id="date" class="form-control col-md-2">

<select id="shift" class="form-control col-md-2">
<option>‡§¶‡§ø‡§®</option>
<option>‡§∞‡§æ‡§§</option>
</select>

<input type="time" id="start" class="form-control col-md-2">
<input type="time" id="end" class="form-control col-md-2">

<input id="work" class="form-control col-md-3" placeholder="‡§ï‡§æ‡§Æ">

<div class="col-md-3">
Font <input type="color" id="fc" value="#000000">
BG <input type="color" id="bc" value="#ffffff">
</div>

<button class="btn btn-success col-md-2">Save</button>

</form>

<hr>

<div class="table-box">

<table class="table table-bordered table-sm">

<thead class="table-light">
<tr>
<th>‡§ï‡§Ç‡§™‡§®‡•Ä</th>
<th>‡§§‡§æ‡§∞‡•Ä‡§ñ</th>
<th>‡§¶‡§ø‡§®</th>
<th>‡§∂‡§ø‡§´‡•ç‡§ü</th>
<th>‡§∏‡§Æ‡§Ø</th>
<th>‡§ï‡§æ‡§Æ</th>
<th>‡§ò‡§Ç‡§ü‡•á</th>
<th>Action</th>
</tr>
</thead>

<tbody id="tbody"></tbody>

</table>

</div>

</div>



<script>

const USER="admin",PASS="12345";

let editIndex=-1;



function secret(){
 if(year.value==1995)
  secretBox.classList.remove("hidden");
}

function login(){
 if(uid.value==USER && pwd.value==PASS){
  localStorage.setItem("login",1);
  loginPage.classList.add("hidden");
  app.classList.remove("hidden");
  load();
 }
}

function logout(){
 localStorage.clear();
 location.reload();
}

if(localStorage.getItem("login")){
 loginPage.classList.add("hidden");
 app.classList.remove("hidden");
 load();
}



function dayName(d){
 return ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date(d).getDay()];
}

function calc(a,b){
 let s=new Date("1970-1-1 "+a);
 let e=new Date("1970-1-1 "+b);
 if(e<s) e.setDate(e.getDate()+1);
 return ((e-s)/3600000).toFixed(2);
}



form.onsubmit=function(e){

 e.preventDefault();

 let data=JSON.parse(localStorage.getItem("duty")||"[]");

 let obj={
  company:company.value,
  date:date.value,
  shift:shift.value,
  start:start.value,
  end:end.value,
  work:work.value,
  fc:fc.value,
  bc:bc.value
 };

 if(editIndex>=0){
  data[editIndex]=obj;
  editIndex=-1;
 }else data.push(obj);

 localStorage.setItem("duty",JSON.stringify(data));

 form.reset();

 load();
};



function load(){

 let data=JSON.parse(localStorage.getItem("duty")||"[]");

 tbody.innerHTML="";

 data.forEach((x,i)=>{

  let tr=document.createElement("tr");

  /* ‚≠ê‚≠ê‚≠ê COLOR FIX ‚≠ê‚≠ê‚≠ê */
  tr.style.color=x.fc || "#000";
  tr.style.backgroundColor=x.bc || "#fff";

  tr.innerHTML=`
  <td>${x.company}</td>
  <td>${new Date(x.date).toLocaleDateString('en-GB')}</td>
  <td>${dayName(x.date)}</td>
  <td>${x.shift}</td>
  <td>${x.start}-${x.end}</td>
  <td>${x.work}</td>
  <td>${calc(x.start,x.end)}</td>
  <td>
  <button onclick="del(${i})" class="btn btn-danger btn-sm">Delete</button>
  </td>`;

  tbody.appendChild(tr);

 });

}



function del(i){
 let d=JSON.parse(localStorage.getItem("duty"));
 d.splice(i,1);
 localStorage.setItem("duty",JSON.stringify(d));
 load();
}

</script>

</body>
 </html>
