<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Duty System</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{background:#eef1f5;font-family:system-ui}
.card{max-width:1200px;margin:25px auto;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,.15)}
.hidden{display:none}
.secret-box{background:#f8f9fa;padding:10px;border-radius:8px;margin-bottom:10px}
</style>
</head>
<body>

<!-- LOGIN PAGE -->
<div id="loginPage" class="card p-4">
<h4 class="text-center">üîê Login Page</h4>

<div class="secret-box">
<input type="number" id="secretYear" class="form-control mb-2" placeholder="Secret Year">
<button class="btn btn-sm btn-secondary w-100" onclick="openSecret()">Secret Option</button>
<div id="secretData" class="hidden mt-2 text-danger">
<b>User:</b> admin <br>
<b>Password:</b> 12345
</div>
</div>

<input id="loginUser" class="form-control mb-2" placeholder="User ID">
<input id="loginPass" type="password" class="form-control mb-2" placeholder="Password">
<button class="btn btn-primary w-100" onclick="login()">Login</button>
</div>

<!-- DUTY PAGE -->
<div id="dutyPage" class="card p-4 hidden">

<div class="d-flex justify-content-between">
<b>‡§°‡•ç‡§Ø‡•Ç‡§ü‡•Ä ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ</b>
<button class="btn btn-danger btn-sm" onclick="logout()">Logout</button>
</div>

<h4 class="text-center mt-2">‡§°‡•ç‡§Ø‡•Ç‡§ü‡•Ä ‡§è‡§Ç‡§ü‡•ç‡§∞‡•Ä</h4>

<form id="entryForm" class="row g-2 mt-2">
<input class="form-control col-md-4" id="company" placeholder="‡§ï‡§Ç‡§™‡§®‡•Ä / ‡§∏‡•ç‡§•‡§æ‡§®" required>
<input type="date" class="form-control col-md-3" id="date" required>

<select id="shift" class="form-control col-md-3">
<option>‡§¶‡§ø‡§®</option>
<option>‡§∞‡§æ‡§§</option>
</select>

<input type="time" id="start" class="form-control col-md-3">
<input type="time" id="end" class="form-control col-md-3">
<input class="form-control col-md-3" id="work" placeholder="‡§ï‡§æ‡§Æ / ‡§®‡•ã‡§ü‡•ç‡§∏">

<div class="col-md-3">
Font <input type="color" id="fontColor">
BG <input type="color" id="bgColor">
</div>

<button class="btn btn-success col-md-3">‡§∏‡•á‡§µ / ‡§Ö‡§™‡§°‡•á‡§ü</button>
</form>

<hr>

<div class="d-flex justify-content-between">
<select id="monthFilter" class="form-select w-auto" onchange="loadData()">
<option value="">‡§∏‡§≠‡•Ä ‡§Æ‡§π‡•Ä‡§®‡•á</option>
<option value="01">January</option><option value="02">February</option>
<option value="03">March</option><option value="04">April</option>
<option value="05">May</option><option value="06">June</option>
<option value="07">July</option><option value="08">August</option>
<option value="09">September</option><option value="10">October</option>
<option value="11">November</option><option value="12">December</option>
</select>

<input id="search" class="form-control w-25" placeholder="Search" onkeyup="loadData()">
</div>

<table class="table table-bordered table-sm mt-2">
<thead class="table-light">
<tr>
<th>#</th><th>‡§ï‡§Ç‡§™‡§®‡•Ä</th><th>‡§§‡§æ‡§∞‡•Ä‡§ñ</th><th>‡§∂‡§ø‡§´‡•ç‡§ü</th>
<th>‡§∏‡§Æ‡§Ø</th><th>‡§ï‡§æ‡§Æ</th><th>Action</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<div class="d-flex justify-content-between">
<div>‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡§æ ‡§ï‡•Å‡§≤ ‡§∏‡§Æ‡§Ø: <b id="monthTotal">0</b> ‡§ò‡§Ç‡§ü‡•á</div>
<div>‡§ï‡•Å‡§≤ ‡§è‡§Ç‡§ü‡•ç‡§∞‡•Ä: <b id="grandTotal">0</b></div>
</div>

</div>

<script>
let edit=-1;
const UID="admin",PWD="12345";

function openSecret(){
 if(secretYear.value==1995)
  secretData.classList.remove("hidden");
 else alert("Wrong Year");
}

function login(){
 if(loginUser.value==UID && loginPass.value==PWD){
  localStorage.setItem("login","yes");
  showDuty();
 } else alert("Wrong Login");
}

function logout(){
 localStorage.removeItem("login");
 location.reload();
}

function showDuty(){
 loginPage.classList.add("hidden");
 dutyPage.classList.remove("hidden");
 loadData();
}

if(localStorage.getItem("login")) showDuty();

entryForm.onsubmit=e=>{
 e.preventDefault();
 let d=JSON.parse(localStorage.getItem("duty"))||[];
 let obj={
  company:company.value,date:date.value,shift:shift.value,
  start:start.value,end:end.value,work:work.value,
  font:fontColor.value,bg:bgColor.value
 };
 if(edit>=0){d[edit]=obj;edit=-1}else d.push(obj);
 localStorage.setItem("duty",JSON.stringify(d));
 entryForm.reset(); loadData();
};

function loadData(){
 let d=JSON.parse(localStorage.getItem("duty"))||[];
 tbody.innerHTML=""; let total=0;
 let m=monthFilter.value, s=search.value.toLowerCase();
 d.forEach((x,i)=>{
  if(m && x.date.substr(5,2)!=m) return;
  if(s && !x.company.toLowerCase().includes(s) && !x.work.toLowerCase().includes(s)) return;

  let h=(new Date("1970-1-1 "+x.end)-new Date("1970-1-1 "+x.start))/36e5;
  if(h>0) total+=h;

  let tr=document.createElement("tr");
  tr.style.color=x.font; tr.style.background=x.bg;
  tr.innerHTML=`
  <td>${i+1}</td><td>${x.company}</td><td>${x.date}</td>
  <td>${x.shift}</td><td>${x.start}-${x.end}</td>
  <td>${x.work}</td>
  <td>
  <button class="btn btn-warning btn-sm" onclick="editRow(${i})">Edit</button>
  <button class="btn btn-danger btn-sm" onclick="del(${i})">Delete</button>
  </td>`;
  tbody.appendChild(tr);
 });
 monthTotal.innerText=total.toFixed(2);
 grandTotal.innerText=d.length;
}

function editRow(i){
 let x=JSON.parse(localStorage.getItem("duty"))[i];
 company.value=x.company;date.value=x.date;shift.value=x.shift;
 start.value=x.start;end.value=x.end;work.value=x.work;
 fontColor.value=x.font;bgColor.value=x.bg; edit=i;
}

function del(i){
 if(confirm("Delete?")){
  let d=JSON.parse(localStorage.getItem("duty"));
  d.splice(i,1); localStorage.setItem("duty",JSON.stringify(d));
  loadData();
 }
}
</script>

</body>
  </html>
