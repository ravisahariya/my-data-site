<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Attendance Master</title>

<style>
body{
font-family: Arial;
margin:0;
background:linear-gradient(135deg,#5f72ff,#9b59b6);
}

/* ===== LOGIN ===== */
#loginBox{
width:95%;
max-width:520px;
margin:60px auto;
background:#fff;
padding:45px;
border-radius:25px;
text-align:center;
box-shadow:0 10px 40px rgba(0,0,0,.3);
}

#loginBox h2{
font-size:32px;
margin-bottom:10px;
}

input,select{
padding:12px;
margin:6px;
font-size:16px;
}

.loginInput{
width:95%;
padding:16px;
font-size:18px;
}

button{
padding:10px 18px;
font-size:15px;
cursor:pointer;
}

#timeNow{
color:#1976d2;
font-weight:bold;
font-size:18px;
margin-bottom:15px;
}

/* ===== DASHBOARD ===== */

#app{display:none;}

header{
background:#1976d2;
color:white;
padding:12px;
font-size:20px;
display:flex;
justify-content:space-between;
align-items:center;
}

.logoutBtn{
background:red;
color:white;
border:none;
padding:8px 14px;
}

#entry{
background:#d9ecff;
padding:10px;
}

table{
width:100%;
border-collapse:collapse;
}

th,td{
border:1px solid #ccc;
padding:6px;
text-align:center;
}

th{
background:#ffdcdc;
}

tbody{
display:block;
height:60vh;
overflow:auto;
}

thead, tbody tr{
display:table;
width:100%;
table-layout:fixed;
}

footer{
background:#ffeaa7;
padding:8px;
font-weight:bold;
}

.night{
background:#e3f2fd;
}
</style>
</head>

<body>

<!-- ================= LOGIN ================= -->
<div id="loginBox">
<h2>üîê Attendance Login</h2>
<div id="timeNow"></div>

<input id="user" class="loginInput" placeholder="Username"><br>
<input id="pass" type="password" class="loginInput" placeholder="Password"><br>

<button onclick="login()">Admin</button>
<button onclick="secret()">üîí Secret</button>
</div>


<!-- ================= APP ================= -->
<div id="app">

<header>
üìä <b>ATTENDANCE MASTER DATA</b>
<button class="logoutBtn" onclick="logout()">Logout</button>
</header>

<div id="entry">
üïí <span id="runClock"></span><br>

<input type="date" id="date">
<input type="time" id="in">
<input type="time" id="out">
<input id="post" placeholder="Post">
<button onclick="save()">Save</button>

<select id="monthFilter" onchange="render()">
<option value="all">All</option>
<option value="0">January</option>
<option value="1">February</option>
<option value="2">March</option>
<option value="3">April</option>
<option value="4">May</option>
<option value="5">June</option>
<option value="6">July</option>
<option value="7">August</option>
<option value="8">September</option>
<option value="9">October</option>
<option value="10">November</option>
<option value="11">December</option>
</select>
</div>

<table>
<thead>
<tr>
<th>Date</th>
<th>In</th>
<th>Out</th>
<th>Hours</th>
<th>Post</th>
<th>Delete</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<footer>
Total Duty: <span id="duty">0</span> |
Total Hours: <span id="hours">0</span>
</footer>

</div>


<script>

/* ================= LOGIN SYSTEM ================= */

if(!localStorage.user){
localStorage.user="9823087";
localStorage.pass="7284";
}

function login(){
if(user.value==localStorage.user && pass.value==localStorage.pass){
localStorage.logged="yes";
showApp();
}else alert("Wrong");
}

function logout(){
localStorage.logged="";
location.reload();
}

function showApp(){
loginBox.style.display="none";
app.style.display="block";
render();
}

if(localStorage.logged=="yes") showApp();


/* ================= SECRET ================= */

function secret(){
let p=prompt("Enter secret");
if(p=="1995"){
let old=prompt("Old password");
if(old!=localStorage.pass) return alert("Wrong");

let u=prompt("New username");
let n=prompt("New password");
let c=prompt("Confirm password");

if(n!=c) return alert("Not match");

localStorage.user=u;
localStorage.pass=n;
alert("Changed");
}
}


/* ================= CLOCK ================= */

function clock(){
let d=new Date();
timeNow.innerText=d.toLocaleString();
runClock.innerText=d.toLocaleString();
}
setInterval(clock,1000);


/* ================= DATA SYSTEM ================= */

let data=JSON.parse(localStorage.data||"[]");

function save(){
let d=date.value;
let i=in.value;
let o=out.value;
let p=post.value;

let h=(new Date("1970-01-01 "+o)-new Date("1970-01-01 "+i))/3600000;
if(h<0) h+=24;

data.push({d,i,o,h:h.toFixed(2),p});
localStorage.data=JSON.stringify(data);
render();
}

function del(x){
data.splice(x,1);
localStorage.data=JSON.stringify(data);
render();
}

function render(){
tbody.innerHTML="";
let m=monthFilter.value;

let totalH=0, totalD=0;

data.forEach((r,i)=>{

let month=new Date(r.d).getMonth();
if(m!="all" && month!=m) return;

let tr=document.createElement("tr");

if(r.i>r.o) tr.className="night";

tr.innerHTML=`
<td>${r.d}</td>
<td>${r.i}</td>
<td>${r.o}</td>
<td>${r.h}</td>
<td>${r.p}</td>
<td><button onclick="del(${i})">‚ùå</button></td>
`;

tbody.appendChild(tr);

totalH+=parseFloat(r.h);
totalD++;
});

duty.innerText=totalD;
hours.innerText=totalH.toFixed(2);
}

</script>
</body>
</html>
