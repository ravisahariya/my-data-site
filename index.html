<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Attendance Master</title>

<style>
body{
margin:0;
font-family:Arial;
background:linear-gradient(135deg,#5f72ff,#9b59b6);
}

/* ================= LOGIN ================= */

#loginPage{
height:100vh;
display:flex;
justify-content:center;
align-items:center;
}

.loginCard{
background:#fff;
width:95%;
max-width:650px;     /* BIGGER */
padding:60px;        /* BIGGER */
border-radius:30px;
text-align:center;
box-shadow:0 20px 60px rgba(0,0,0,.4);
}

.loginCard h1{
font-size:40px;
margin-bottom:10px;
}

.loginInput{
width:100%;
padding:20px;
margin:15px 0;
font-size:20px;
border-radius:10px;
}

.loginBtn{
width:100%;
padding:18px;
font-size:22px;
margin-top:10px;
}

#clock{
font-size:20px;
color:#1976d2;
font-weight:bold;
margin-bottom:15px;
}

/* ================= APP ================= */

#app{
display:none;
height:100vh;
flex-direction:column;
}

header{
background:#1565c0;
color:white;
padding:12px;
font-size:20px;
display:flex;
justify-content:space-between;
position:sticky;
top:0;
}

.logoutBtn{
background:red;
color:white;
border:none;
padding:8px 15px;
}

/* blue entry */
#entry{
background:#d9ecff;
padding:10px;
}

/* table */
table{
width:100%;
border-collapse:collapse;
}

th,td{
border:1px solid #ccc;
padding:6px;
text-align:center;
}

th{
background:#ffd6d6;
}

/* ONLY ROW SCROLL */
tbody{
display:block;
height:60vh;
overflow:auto;
}

thead, tbody tr{
display:table;
width:100%;
table-layout:fixed;
}

footer{
background:#ffeaa7;
padding:10px;
font-weight:bold;
position:sticky;
bottom:0;
}

.night{
background:#e3f2fd;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginPage">
<div class="loginCard">

<h1>üîê Attendance Login</h1>
<div id="clock"></div>

<input id="username" class="loginInput" placeholder="Username">
<input id="password" type="password" class="loginInput" placeholder="Password">

<button class="loginBtn" onclick="doLogin()">Login</button>
<button class="loginBtn" onclick="secret()">üîí Secret</button>

</div>
</div>


<!-- APP -->
<div id="app">

<header>
üìä ATTENDANCE MASTER DATA
<button class="logoutBtn" onclick="logout()">Logout</button>
</header>

<div id="entry">
üïí <span id="runClock"></span><br>

<input type="date" id="date">
<input type="time" id="inTime">
<input type="time" id="outTime">
<input id="post" placeholder="Post">
<button onclick="save()">Save</button>

<select id="monthFilter" onchange="render()">
<option value="all">All</option>
<option value="0">January</option>
<option value="1">February</option>
<option value="2">March</option>
<option value="3">April</option>
<option value="4">May</option>
<option value="5">June</option>
<option value="6">July</option>
<option value="7">August</option>
<option value="8">September</option>
<option value="9">October</option>
<option value="10">November</option>
<option value="11">December</option>
</select>
</div>

<table>
<thead>
<tr>
<th>Date</th>
<th>In</th>
<th>Out</th>
<th>Hours</th>
<th>Post</th>
<th>Delete</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<footer>
Total Duty: <span id="duty">0</span> |
Total Hours: <span id="hours">0</span>
</footer>

</div>

<script>

/* DEFAULT LOGIN */
if(!localStorage.user){
localStorage.user="9823087";
localStorage.pass="7284";
}

/* LOGIN FUNCTION (FIXED) */
function doLogin(){
let u=document.getElementById("username").value;
let p=document.getElementById("password").value;

if(u===localStorage.user && p===localStorage.pass){
localStorage.logged="yes";
showApp();
}else{
alert("Wrong Username/Password");
}
}

function logout(){
localStorage.logged="";
location.reload();
}

function showApp(){
loginPage.style.display="none";
app.style.display="flex";
render();
}

if(localStorage.logged==="yes") showApp();

/* SECRET */
function secret(){
let s=prompt("Enter secret year");
if(s==="1995"){
alert("Username: "+localStorage.user+"\nPassword: "+localStorage.pass);

let old=prompt("Old password");
if(old!==localStorage.pass) return;

let nu=prompt("New username");
let np=prompt("New password");
let cp=prompt("Confirm password");

if(np!==cp) return alert("Not match");

localStorage.user=nu;
localStorage.pass=np;

alert("Changed!");
}
}

/* CLOCK */
function tick(){
let d=new Date();
let t=d.toLocaleString();
clock.innerText=t;
runClock.innerText=t;
}
setInterval(tick,1000);

/* DATA */
let data=JSON.parse(localStorage.data||"[]");

function save(){
let d=date.value,i=inTime.value,o=outTime.value,p=post.value;

let h=(new Date("1970 "+o)-new Date("1970 "+i))/3600000;
if(h<0)h+=24;

data.push({d,i,o,h:h.toFixed(2),p});
localStorage.data=JSON.stringify(data);
render();
}

function del(i){
data.splice(i,1);
localStorage.data=JSON.stringify(data);
render();
}

function render(){
tbody.innerHTML="";
let m=monthFilter.value;

let td=0,th=0;

data.forEach((r,i)=>{
let month=new Date(r.d).getMonth();
if(m!=="all" && month!=m) return;

let tr=document.createElement("tr");
if(r.i>r.o) tr.className="night";

tr.innerHTML=`
<td>${r.d}</td>
<td>${r.i}</td>
<td>${r.o}</td>
<td>${r.h}</td>
<td>${r.p}</td>
<td><button onclick="del(${i})">‚ùå</button></td>
`;

tbody.appendChild(tr);

td++;
th+=parseFloat(r.h);
});

duty.innerText=td;
hours.innerText=th.toFixed(2);
}
</script>
</body>
</html>
