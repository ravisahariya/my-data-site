<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Data Page</title>

<style>
body{
  font-family: Arial;
  background:#f2f2f2;
}
.box{
  background:#fff;
  max-width:480px;
  margin:15px auto;
  padding:15px;
  border-radius:8px;
}
input, select, textarea, button{
  width:100%;
  padding:8px;
  margin:6px 0;
}
button{
  border:none;
  color:#fff;
  border-radius:5px;
}
.blue{background:#007bff;}
.green{background:#28a745;}
.red{background:#dc3545;}
.data-box{
  border:1px solid #ccc;
  padding:8px;
  margin:8px 0;
  border-radius:6px;
}
img{
  max-width:80px;
  display:block;
  margin:5px 0;
}
</style>
</head>

<body>

<div class="box">
<h3>ЁЯУБ My Data Page</h3>

<input id="name" placeholder="рдирд╛рдо">
<select id="gender">
  <option value="">рд▓рд┐рдВрдЧ</option>
  <option>рдкреБрд░реБрд╖</option>
  <option>рдорд╣рд┐рд▓рд╛</option>
</select>
<input id="father" placeholder="рдкрд┐рддрд╛ рдХрд╛ рдирд╛рдо">
<input id="mobile" placeholder="рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░">
<textarea id="address" placeholder="рдкрддрд╛"></textarea>

<label>рдлреЛрдЯреЛ:</label>
<input type="file" id="photo" accept="image/*">

<label>рд▓реЛрдЧреЛ:</label>
<input type="file" id="logo" accept="image/*">

<label>рддрд╛рд░реАрдЦ:</label>
<input type="date" id="date">

<label>рд╕рдордп:</label>
<input type="time" id="time">

<label>рдЖрдиреЗ рдХрд╛ рд╕рдордп:</label>
<input type="time" id="inTime">

<label>рдЬрд╛рдиреЗ рдХрд╛ рд╕рдордп:</label>
<input type="time" id="outTime">

<button class="blue" onclick="saveData()">Submit</button>
<button class="green" onclick="downloadExcel()">Download Excel</button>
<button class="green" onclick="downloadPDF()">Download PDF</button>
<button class="red" onclick="clearAll()">Clear All</button>

<hr>
<h4>ЁЯУВ Saved Data</h4>
<div id="output"></div>
</div>

<script>
let editIndex = -1;

function saveData(){
  let data = JSON.parse(localStorage.getItem("myData")) || [];

  let obj = {
    name:name.value,
    gender:gender.value,
    father:father.value,
    mobile:mobile.value,
    address:address.value,
    date:date.value,
    time:time.value,
    inTime:inTime.value,
    outTime:outTime.value,
    photo:"",
    logo:""
  };

  if(photo.files[0]){
    let r = new FileReader();
    r.onload = ()=>{ obj.photo=r.result; finish(obj,data); };
    r.readAsDataURL(photo.files[0]);
  }else if(logo.files[0]){
    let r = new FileReader();
    r.onload = ()=>{ obj.logo=r.result; finish(obj,data); };
    r.readAsDataURL(logo.files[0]);
  }else{
    finish(obj,data);
  }
}

function finish(obj,data){
  if(editIndex>-1){
    data[editIndex]=obj;
    editIndex=-1;
  }else{
    data.push(obj);
  }
  localStorage.setItem("myData",JSON.stringify(data));
  clearForm();
  showData();
}

function showData(){
  let data = JSON.parse(localStorage.getItem("myData")) || [];
  let out="";
  data.forEach((d,i)=>{
    out+=`
    <div class="data-box">
    <b>${i+1}. ${d.name}</b><br>
    ${d.gender}<br>
    рдкрд┐рддрд╛: ${d.father}<br>
    ЁЯУЮ ${d.mobile}<br>
    ЁЯУН ${d.address}<br>
    ЁЯУЕ ${d.date} тП░ ${d.time}<br>
    рдЖрдиреЗ: ${d.inTime} | рдЬрд╛рдиреЗ: ${d.outTime}<br>
    ${d.photo?`<img src="${d.photo}">`:""}
    ${d.logo?`<img src="${d.logo}">`:""}
    <button class="blue" onclick="editData(${i})">Edit</button>
    <button class="red" onclick="deleteData(${i})">Delete</button>
    </div>`;
  });
  output.innerHTML=out;
}

function editData(i){
  let d = JSON.parse(localStorage.getItem("myData"))[i];
  name.value=d.name;
  gender.value=d.gender;
  father.value=d.father;
  mobile.value=d.mobile;
  address.value=d.address;
  date.value=d.date;
  time.value=d.time;
  inTime.value=d.inTime;
  outTime.value=d.outTime;
  editIndex=i;
}

function deleteData(i){
  let data = JSON.parse(localStorage.getItem("myData"));
  data.splice(i,1);
  localStorage.setItem("myData",JSON.stringify(data));
  showData();
}

function clearForm(){
  document.querySelectorAll("input,textarea,select").forEach(e=>e.value="");
}

function clearAll(){
  if(confirm("рдкреВрд░рд╛ data delete рдХрд░реЗрдВ?")){
    localStorage.removeItem("myData");
    showData();
  }
}

function downloadExcel(){
  let data = JSON.parse(localStorage.getItem("myData"))||[];
  let csv="рдирд╛рдо,рд▓рд┐рдВрдЧ,рдкрд┐рддрд╛,рдореЛрдмрд╛рдЗрд▓,рдкрддрд╛,рддрд╛рд░реАрдЦ,рд╕рдордп,рдЖрдиреЗ,рдЬрд╛рдиреЗ\n";
  data.forEach(d=>{
    csv+=`${d.name},
