<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Register + Attendance</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#0b4d2e;
}
.card{
  max-width:430px;
  margin:20px auto;
  background:#fff;
  padding:15px;
  border-radius:10px;
}
h2{text-align:center;margin:5px 0}
input,select,button{
  width:100%;
  padding:8px;
  margin:6px 0;
  font-size:14px;
}
button{
  background:#0b4d2e;
  color:#fff;
  border:none;
  border-radius:5px;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
  font-size:13px;
}
th,td{
  border:1px solid #ccc;
  padding:5px;
  text-align:center;
}
th{background:#eee}
.settings{
  float:right;
  font-size:18px;
  cursor:pointer;
}
.hidden{display:none}
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  display:flex;
  align-items:center;
  justify-content:center;
}
.popup div{
  background:#fff;
  padding:15px;
  border-radius:8px;
  width:250px;
  text-align:center;
}
</style>
</head>

<body>

<!-- LOGIN PAGE -->
<div class="card" id="loginPage">
  <h2>üë§ Admin Login</h2>
  <select disabled><option><b>ADMIN</b></option></select>
  <input type="password" id="password" placeholder="Password">
  <button onclick="login()">Login</button>
</div>

<!-- MAIN APP -->
<div class="card hidden" id="appPage">
  <span class="settings" onclick="openSettings()">‚öôÔ∏è</span>
  <h2>Register + Attendance</h2>

  <!-- Month -->
  <select id="month" onchange="renderTable()">
    <option>January</option><option>February</option><option>March</option>
    <option>April</option><option>May</option><option>June</option>
    <option>July</option><option>August</option><option>September</option>
    <option>October</option><option>November</option><option>December</option>
  </select>

  <!-- Date -->
  <input type="date" id="date">

  <!-- Shift -->
  <select id="shift">
    <option>Day</option>
    <option>Night</option>
  </select>

  <!-- Post -->
  <select id="post">
    <option>COE</option>
    <option>ABEER</option>
    <option>DENIEM</option>
    <option>ETP</option>
    <option>ACL</option>
    <option>BORD2</option>
    <option>CASUAL</option>
    <option>CCTV</option>
  </select>

  <!-- Signature -->
  <select disabled><option>Ravi</option></select>

  <!-- Color -->
  <input type="color" id="color" value="#ffffff">

  <button onclick="saveEntry()">Save Entry</button>

  <!-- TABLE -->
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Shift</th>
        <th>Post</th>
        <th>Edit</th>
        <th>Del</th>
      </tr>
    </thead>
    <tbody id="table"></tbody>
    <tfoot>
      <tr>
        <th>Total</th>
        <th id="dayCount">0</th>
        <th id="nightCount">0</th>
        <th colspan="2" id="totalCount">0</th>
      </tr>
    </tfoot>
  </table>
</div>

<!-- SETTINGS POPUP -->
<div class="popup hidden" id="settings">
  <div>
    <h3>Settings</h3>
    <button onclick="logout()">Logout</button>
    <br><br>
    <button onclick="closeSettings()">Close</button>
  </div>
</div>

<script>
const PASS="7024";
let editIndex=-1;

function login(){
  if(document.getElementById("password").value===PASS){
    localStorage.setItem("logged","yes");
    showApp();
  }else alert("Wrong Password");
}
function showApp(){
  loginPage.classList.add("hidden");
  appPage.classList.remove("hidden");
}
function logout(){
  localStorage.removeItem("logged");
  location.reload();
}
if(localStorage.getItem("logged")==="yes") showApp();

function saveEntry(){
  let date=document.getElementById("date").value;
  if(!date){alert("Date required");return;}

  let data=JSON.parse(localStorage.getItem("data")||"[]");

  let entry={
    month:month.value,
    date,
    shift:shift.value,
    post:post.value,
    color:color.value,
    sign:"Ravi"
  };

  if(editIndex==-1) data.push(entry);
  else{data[editIndex]=entry;editIndex=-1;}

  localStorage.setItem("data",JSON.stringify(data));
  renderTable();
  window.scrollTo({top:0,behavior:"smooth"});
}

function renderTable(){
  let body=document.getElementById("table");
  body.innerHTML="";
  let data=JSON.parse(localStorage.getItem("data")||"[]");
  let m=month.value;

  data=data.filter(d=>d.month===m)
           .sort((a,b)=>new Date(a.date)-new Date(b.date));

  let day=0,night=0;

  data.forEach((e,i)=>{
    if(e.shift==="Day") day++;
    if(e.shift==="Night") night++;

    let tr=document.createElement("tr");
    tr.style.background=e.color;
    tr.innerHTML=`
      <td>${new Date(e.date).toLocaleDateString("en-GB")}</td>
      <td>${e.shift}</td>
      <td>${e.post}</td>
      <td><button onclick="editRow(${i})">‚úèÔ∏è</button></td>
      <td><button onclick="delRow(${i})">‚ùå</button></td>
    `;
    body.appendChild(tr);
  });

  dayCount.innerText=day;
  nightCount.innerText=night;
  totalCount.innerText=day+night;
}

function editRow(i){
  let data=JSON.parse(localStorage.getItem("data"));
  let e=data.filter(d=>d.month===month.value)[i];
  date.value=e.date;
  shift.value=e.shift;
  post.value=e.post;
  color.value=e.color;
  editIndex=data.indexOf(e);
}

function delRow(i){
  if(!confirm("Delete entry?"))return;
  let data=JSON.parse(localStorage.getItem("data"));
  let filtered=data.filter(d=>d.month===month.value);
  data.splice(data.indexOf(filtered[i]),1);
  localStorage.setItem("data",JSON.stringify(data));
  renderTable();
}

function openSettings(){settings.classList.remove("hidden")}
function closeSettings(){settings.classList.add("hidden")}

renderTable();
</script>

</body>
  </html>
